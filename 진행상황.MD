# 진행상황 요약 (부산 소상공인 AI 마케팅 매니저)

## 개요
- Vite + React + TypeScript + Tailwind 기반 SPA.
- 백엔드: Vercel Serverless Function (`api/generate.js`)로 Solar Pro 호출.
- 로컬 데이터: 지역 인사이트(`api/busanData.js`/`src/data/busanData.ts`), 축제 CSV, 날씨/축제 유틸.

## 프론트엔드 구조/기능
- `src/main.tsx` / `src/App.tsx`: QueryClientProvider 설정, 레이아웃 구성(Header/Footer/폼/결과).
- 입력 폼 `src/components/Form/PromotionForm.tsx`:
  - 가게명, 위치(input+datalist: 서면/전포·광안리·해운대·남포동(자갈치/국제시장)·기장(오시리아)·영도(흰여울) + 자유입력), 메뉴/이벤트, 이미지 업로드(미리보기), “오늘 우리 동네 날씨/이슈 반영” 체크박스(default ON).
  - `/api/generate` POST: `storeName/description/location/includeTrends/imageBase64` 전송. 응답의 `feed/story/map/sms` 또는 `results.*`를 읽어 결과 표시/복사.
- 결과 표시 `src/components/Result/*`: 채널별 블록 + 복사 버튼. 컨텍스트 요약 표시.
- 스타일: `src/styles/index.css` Tailwind + 그라디언트 배경.

## 백엔드(Serverless) 기능
- 엔드포인트: `api/generate.js`
  - env: `UPSTAGE_API_KEY` 필요(.env.local 로드, Vercel env 지원).
  - 지역 인사이트: `getInsight`(부분 일치 매칭, 미매칭 시 기타/동네 톤).
  - 트렌드: 요일/시간/날씨 프리셋 생성해 feed/sms에 반영 지시 (`includeTrends` true).
  - 프롬프트: 채널별 규칙(피드/스토리/지도/문자) 명시, JSON 포맷 강제.
  - 응답: Solar 결과 JSON 파싱(fenced JSON 허용) → `feed/story/map/sms` + `results.instagram_*` 구조로 반환. 파싱 실패 시 전체 텍스트를 채널별 동일하게 fallback.
- 로컬 데이터/유틸:
  - `api/busanData.js` / `src/data/busanData.ts`: 서면/전포, 광안리, 해운대, 남포동(자갈치/국제시장), 기장(오시리아), 영도(흰여울), 기타(동네) 인사이트(타겟/페르소나/톤/해시태그/포인트).
  - `api/festivalUtils.js`: 축제 CSV(`src/data/busan_festival.csv`) 파싱, 날짜 필터로 활성 축제 조회, 동네→구군 매핑.
  - `api/weatherUtils.js`: wttr.in 호출 기반 날씨 텍스트(실패 시 프리셋).

## API 클라이언트/훅
- `src/api/client.ts`: axios 클라이언트(baseURL = VITE_API_BASE_URL || '').
- `src/api/promotion.ts`: `/api/generate` 호출 + 실패 시 목업; `/api/local-context` 목업.
- `src/hooks/useGeneratePromotion.ts`: React Query mutation/query 래퍼.

## 진행 상황/남은 과제
- 동작: 프론트→`/api/generate` 연동 완료, 이미지 업로드는 텍스트 언급만(모델이 이미지 미지원).
- env: `.env.local`에 `UPSTAGE_API_KEY` 필요, Vite dev가 아닌 `vercel dev` 또는 배포 환경에서 호출해야 함수 실행.
- TODO 아이디어: 프론트 UI에 채널별 출력 필드 분리(현재 동일 텍스트 fallback 가능), 축제/날씨 유틸을 generate 프롬프트에 통합, axios baseURL을 Vercel dev(3000) 기준으로 설정.
